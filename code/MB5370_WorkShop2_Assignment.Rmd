---
title: "MB5370_WorkShop2_Assignment"
author: "Chik Hei Yeung"
date: "2024-05-16"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
#----------------------------------------------------------------------------------

#Import data set
```{r}
library(readr)
dat <- read_csv("../data/Qfish_shark_data.csv")
dat
```

#download colour package
```{r}
#install.packages("viridis")
library(viridis)
```

#tidy data
```{r}
str(dat)   #show structure of data frame
dat$CalendarYear = as.numeric(dat$CalendarYear)
filtered_dat <- dat %>%
  filter(!grepl("Total", CalendarYear)) %>%
  filter(!grepl("Total", Area))
```
#obmit NA in dataset
```{r}
filtered_dat <- filtered_dat %>% filter(if_any(everything(), ~ !is.na(.)))
print(filtered_dat)

```

#ggplot
```{r}
#install.packages("tidyverse") # Delete this line once installed
library("tidyverse")
```


#plot figure
```{r}
ggplot(data = filtered_dat) + 
  geom_smooth(mapping = aes(x = `NumberCaught Total`, y = `CalendarYear`, colour = Area))
```

```{r}
ggplot(data = filtered_dat) + 
  geom_line(mapping = aes(x = `CalendarYear`, y = `NumberCaught Total`, colour = Area ))

#ggplot(data = filtered_dat) + 
  #geom_line(mapping = aes(x = `CalendarYear`, y = `NumberCaught Total`, colour = Area ))#
```

```{r}
ggplot(data = filtered_dat) + 
  geom_bar(mapping = aes(x = `CalendarYear`, fill = `Area`), position = "stack")
```

```{r}
ggplot(data = filtered_dat) + 
  geom_bar(mapping = aes(x = `CalendarYear`, fill = `Area`), position = "fill")

```

```{r}
ggplot(data = filtered_dat) + 
  geom_bar(mapping = aes(x = `CalendarYear`, y = `NumberCaught Total`, fill = Area), position = "stack", stat = "identity") +
  scale_colour_viridis()
```

```{r}
ggplot(data = filtered_dat) + 
  geom_bar(mapping = aes(x = `CalendarYear`, y = `NumberCaught Total`, fill = Area), 
           position = "stack", stat = "identity") +
  scale_fill_viridis_d()
```

```{r}
ggplot(data = filtered_dat) + 
  geom_bar(mapping = aes(x = `CalendarYear`, y = `NumberCaught Total`, fill = Area), 
           position = "stack", stat = "identity") +
  scale_fill_viridis_d() + 
  facet_wrap(~ SpeciesGroup)
```

